<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>OptiPDF — Fast, private PDF tools</title>

  <!-- One-file, mobile-first, clean reset. No tiles; each tool lives with its action. -->
  <style>
    :root{
      --bg:#f3f4f6;        /* soft gray background */
      --card:#ffffff;      /* white cards */
      --border:#e5e7eb;    /* light border */
      --text:#111827;      /* near-black text */
      --muted:#374151;     /* darker gray body */
      --brand:#2563eb;     /* accessible blue */
      --brand-700:#1d4ed8; /* darker hover blue */
    }
    /* base */
    *{box-sizing:border-box}
    html{scroll-behavior:smooth}
    body{margin:0;background:var(--bg);color:var(--text);font:16px/1.5 system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif}
    img{max-width:100%;display:block}

    .container{max-width:1100px;margin:0 auto;padding:16px}
    .row{display:flex;flex-wrap:wrap;gap:10px;align-items:center}

    /* header */
    header{position:sticky;top:0;z-index:30;background:#fff;border-bottom:1px solid var(--border)}
    .header{display:flex;align-items:center;gap:12px}
    .brand-left{display:flex;align-items:center;gap:10px}
    .logo{height:18px}
    .brand{font-weight:800;font-size:1.08rem}
    nav.nav{margin-left:auto;display:flex;gap:14px;white-space:nowrap}
    nav.nav a{color:#374151;text-decoration:none;font-weight:600}
    nav.nav a:hover{color:var(--brand)}
    @media (min-width:1000px){ .logo{height:20px} .brand{font-size:1.24rem} }
    @media (max-width:560px){ header{padding:8px 12px} }

    /* hero */
    .hero{padding:16px 0}
    .hero-grid{display:grid;grid-template-columns:1fr;gap:16px;align-items:center}
    .hero h1{margin:0 0 6px;font-size:1.5rem;line-height:1.2}
    .hero p{margin:.25rem 0 1rem;color:var(--muted)}
    .btn{display:inline-flex;align-items:center;justify-content:center;gap:.5rem;font-weight:700;border-radius:12px;border:1px solid transparent;padding:12px 16px;cursor:pointer;transition:box-shadow .08s ease,transform .06s ease}
    .btn:active{transform:translateY(1px)}
    .btn-primary{background:var(--brand);color:#fff;border-color:var(--brand)}
    .btn-primary:hover{background:var(--brand-700)}
    .btn-secondary{background:#fff;color:var(--brand);border-color:var(--brand)}
    .btn-secondary:hover{background:#eef2ff}
    .note{font-size:.92rem;color:var(--muted)}
    .hero-media video{width:100%;border-radius:14px;background:#000;border:1px solid var(--border)}
    /* side-by-side on wide screens */
    @media (min-width:960px){ .hero-grid{grid-template-columns:1fr 1fr} }

    /* tools (accordion cards) */
    .tool{background:var(--card);border:1px solid var(--border);border-radius:16px;margin:14px 0;overflow:hidden}
    .tool>summary{list-style:none;cursor:pointer;padding:14px 16px;font-weight:800;display:flex;align-items:center;justify-content:space-between}
    .tool>summary::-webkit-details-marker{display:none}
    .tool>summary span{color:var(--muted);font-weight:600;font-size:.95rem}
    .tool .content{padding:0 16px 16px}

    input[type="text"],input[type="number"],select{padding:10px 12px;border:1px solid var(--border);border-radius:10px;min-width:140px;background:#fff}

    /* footer */
    footer{margin:22px 0 40px;text-align:center;color:#6b7280}

    /* safety: if old UI leaked below footer, hide it */
    footer ~ *{display:none !important}
  </style>
</head>
<body>
  <header>
    <div class="container header">
      <div class="brand-left">
        <!-- Change src to your real logo path if needed -->
        <img src="icons/icon-192.png" alt="OptiPDF logo" class="logo">
        <div class="brand">OptiPDF</div>
      </div>
      <nav class="nav" aria-label="Primary">
        <a href="#merge">Merge</a>
        <a href="#split">Split</a>
        <a href="#rotate">Rotate</a>
        <a href="#reorder">Reorder</a>
        <a href="#view">View</a>
      </nav>
    </div>
  </header>

  <main>
    <!-- HERO: CTA + Video; stacks on phones, side-by-side on desktop -->
    <section class="hero">
      <div class="container hero-grid">
        <div class="hero-cta">
          <h1>Fast, private PDF tools</h1>
          <p>Everything runs in your browser. Nothing is uploaded.</p>
          <button id="openPdfBtn" class="btn btn-primary">Choose PDF</button>
          <input type="file" id="pdfInput" accept="application/pdf" hidden>
          <div class="note">Or pick a tool below.</div>
        </div>
        <div class="hero-media">
          <!-- Optional video (change path to your video if you have one) -->
          <video controls preload="metadata" poster="assets/cover.jpg">
            <source src="assets/intro.mp4" type="video/mp4" />
          </video>
        </div>
      </div>
    </section>

    <!-- MERGE -->
    <details id="merge" class="container tool" open>
      <summary>Merge PDFs <span>Combine multiple files</span></summary>
      <div class="content">
        <div class="row">
          <button class="btn btn-secondary pick" data-tool="merge" data-multiple="true">Select PDFs</button>
          <button class="btn btn-primary run" data-tool="merge" disabled>Merge (stub)</button>
        </div>
      </div>
    </details>

    <!-- SPLIT -->
    <details id="split" class="container tool">
      <summary>Split PDF <span>Cut into ranges</span></summary>
      <div class="content">
        <div class="row">
          <button class="btn btn-secondary pick" data-tool="split">Choose PDF</button>
          <input type="text" id="ranges" placeholder="Ranges e.g. 1-3,5,7-9">
          <button class="btn btn-primary run" data-tool="split" disabled>Split (stub)</button>
        </div>
      </div>
    </details>

    <!-- REORDER -->
    <details id="reorder" class="container tool">
      <summary>Reorder pages <span>Drag to rearrange</span></summary>
      <div class="content">
        <div class="row">
          <button class="btn btn-secondary pick" data-tool="reorder">Choose PDF</button>
          <button class="btn btn-primary run" data-tool="reorder" disabled>Open Reorder (stub)</button>
        </div>
      </div>
    </details>

    <!-- ROTATE -->
    <details id="rotate" class="container tool">
      <summary>Rotate pages <span>90°/180°/270°</span></summary>
      <div class="content">
        <div class="row">
          <button class="btn btn-secondary pick" data-tool="rotate">Choose PDF</button>
          <select id="deg">
            <option value="90">90°</option>
            <option value="180">180°</option>
            <option value="270">270°</option>
          </select>
          <button class="btn btn-primary run" data-tool="rotate" disabled>Rotate (stub)</button>
        </div>
      </div>
    </details>

    <!-- PAGE NUMBERS -->
    <details id="pagenum" class="container tool">
      <summary>Page numbers <span>Bottom center</span></summary>
      <div class="content">
        <div class="row">
          <button class="btn btn-secondary pick" data-tool="pagenum">Choose PDF</button>
          <select id="pos">
            <option value="bottom-center">Bottom-center</option>
            <option value="bottom-right">Bottom-right</option>
            <option value="top-right">Top-right</option>
          </select>
          <button class="btn btn-primary run" data-tool="pagenum" disabled>Add numbers (stub)</button>
        </div>
      </div>
    </details>

    <!-- WATERMARK -->
    <details id="watermark" class="container tool">
      <summary>Text watermark <span>Overlay text</span></summary>
      <div class="content">
        <div class="row">
          <button class="btn btn-secondary pick" data-tool="watermark">Choose PDF</button>
          <input type="text" id="wmtext" placeholder="Watermark text">
          <input type="number" id="opacity" min="10" max="100" value="40" style="width:110px" title="Opacity %">
          <button class="btn btn-primary run" data-tool="watermark" disabled>Apply (stub)</button>
        </div>
      </div>
    </details>

    <!-- METADATA -->
    <details id="metadata" class="container tool">
      <summary>Metadata <span>Edit fields</span></summary>
      <div class="content">
        <div class="row">
          <button class="btn btn-secondary pick" data-tool="metadata">Choose PDF</button>
          <input type="text" id="title" placeholder="Title">
          <input type="text" id="author" placeholder="Author">
          <input type="text" id="subject" placeholder="Subject">
          <button class="btn btn-primary run" data-tool="metadata" disabled>Save (stub)</button>
        </div>
      </div>
    </details>

    <!-- VIEW -->
    <details id="view" class="container tool">
      <summary>View PDF <span>Preview first page</span></summary>
      <div class="content">
        <div class="row">
          <button class="btn btn-secondary pick" data-tool="view">Choose PDF</button>
        </div>
        <div style="margin-top:10px">
          <canvas id="pdfCanvas" style="width:100%;max-width:900px;border:1px solid var(--border);border-radius:12px;background:#fff"></canvas>
        </div>
      </div>
    </details>

  </main>

  <footer>
    © 2025 OptiPDF — fast, private, in‑browser.
  </footer>

  <!-- PDF.js CDN for the View tool only -->
  <script src="https://cdn.jsdelivr.net/npm/pdfjs-dist@3.11.174/build/pdf.min.js"></script>
  <script>pdfjsLib.GlobalWorkerOptions.workerSrc = "https://cdn.jsdelivr.net/npm/pdfjs-dist@3.11.174/build/pdf.worker.min.js";</script>

  <!-- Minimal JS: file picking + enable RUN + basic viewer (page 1) -->
  <script>
    const input = document.getElementById('pdfInput');
    const openBtn = document.getElementById('openPdfBtn');
    const pickButtons = document.querySelectorAll('.pick');
    const runButtons  = document.querySelectorAll('.run');

    let currentTool = null;

    // From hero button
    openBtn?.addEventListener('click', () => { currentTool = 'view'; input.multiple = false; input.click(); });

    // From each tool card
    pickButtons.forEach(btn => {
      btn.addEventListener('click', () => {
        currentTool = btn.dataset.tool;
        input.multiple = btn.dataset.multiple === 'true';
        input.click();
      });
    });

    function enableRunFor(tool){
      document.querySelectorAll('.run[data-tool]').forEach(b => {
        b.disabled = (b.dataset.tool !== tool);
      });
      document.getElementById(tool)?.setAttribute('open','open');
    }

    async function renderFirstPage(file){
      const canvas = document.getElementById('pdfCanvas');
      if(!canvas || !file) return;
      const ctx = canvas.getContext('2d');
      const buf = await file.arrayBuffer();
      const pdf = await pdfjsLib.getDocument({ data: buf }).promise;
      const page = await pdf.getPage(1);
      const scale = 1.5;
      const viewport = page.getViewport({ scale });
      canvas.width = viewport.width; canvas.height = viewport.height;
      await page.render({ canvasContext: ctx, viewport }).promise;
    }

    input?.addEventListener('change', async (e) => {
      const files = Array.from(e.target.files || []);
      if(!files.length) return;
      enableRunFor(currentTool || 'view');
      if((currentTool || 'view') === 'view'){
        await renderFirstPage(files[0]);
        document.getElementById('view')?.scrollIntoView({behavior:'smooth'});
      }
    });

    runButtons.forEach(btn => btn.addEventListener('click', () => {
      const tool = btn.dataset.tool;
      alert(`${tool.toUpperCase()} — wiring coming next. Files stay on your device.`);
    }));
  </script>
</body>
</html>
